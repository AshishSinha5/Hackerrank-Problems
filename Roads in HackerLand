
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <stdlib.h>
#include <limits.h>
int V,sum=0;

int min(int x,int y)
    {
    return (x<y?x:y);
}
int minimum(int dist[],int s[])
    {
    int min=INT_MAX,minIndex;
    for(int v=0;v<V;v++)
        if(s[v]==0&&dist[v]<=min)
            {
            minIndex=v;
           min=dist[v];
        }
    
    return minIndex;
}
int printSolution(int dist[], int n,int src)
{
  // printf("Vertex   Distance from Source\n");
    
   for (int i = 0; i < V; i++)
       
       if(i<=src)
      continue;
     
//else if(dist[i]>=INT_MAX)
      // printf("-1 ");
       else{
        sum=sum+dist[i];
     printf("%d ", dist[i]);
   }
   return (sum);
}





int dijkestra(int cost[V][V],int src)
    {
    int i,j;
       for(i=0;i<V;i++){
           src=i;
      int dist[V],s[V];
   /* for(i=0;i<V;i++){
             for(j=0;j<V;j++){
        printf("%d ",cost[i][j]);
        }      
           printf("\n");
       }*/
    for(int i=0;i<V;i++){
        s[i]=0;
    dist[i]=INT_MAX;
    }
    dist[src]=0;
    
for(int k=0;k<V-1;k++)
{
   int u=minimum(dist,s);
    s[u]=1;
   

    for(int v=0;v<V;v++)
        {  
        //printf("[%d][%d] %d",u,v,dist[u]+cost[u][v]);
          if(cost[u][v]&&s[v]==0&&(dist[u]+cost[u][v])<dist[v]&&dist[u]!=INT_MAX)
            dist[v]=dist[u]+cost[u][v];
    }
//  
  
}
       for (int i = 0; i < V; i++)
       
       if(i<=src)
      continue;
       else
        sum=sum+dist[i];
   
    
       }

 return sum; 
  
  
}
int main()
    {
    int u,v,i,j,T,E,w,src;
   //scanf("%d",&T);
    //while(T--){
    scanf("%d %d", &V,&E);
        int graph[V][V];
         for(i=0;i<V;i++)
        for(j=0;j<V;j++)
    graph[i][j]=0;
        
    for(i=0;i<E;i++){
        scanf("%d %d %d",&u,&v,&w);
             w=pow(2,w);
       if(graph[u-1][v-1]==0||graph[u-1][v-1]>w)
        {
            graph[u-1][v-1]=w;
           graph[v-1][u-1]=w;
         if(graph[u-1][v-1]!=0&&graph[u-1][v-1]>w)
        {
            graph[u-1][v-1]=min(graph[u-1][v-1],w);
           graph[v-1][u-1]=min(graph[u-1][v-1],w);
        }
         }
         }
       /*for(i=0;i<V;i++){
             for(j=0;j<V;j++){
        printf("%d ",graph[i][j]);
        }      
           printf("\n");
       }*/
      
    //printf("%d %d %d",u,v,w);
    
    
   // scanf("%d",&w);
 
    
       //scanf("%d",&src);
     // for(i=0;i<V;i++)
     sum= dijkestra(graph,i);
   // printf("\n");
     printf("S%dS ", sum);
     long long binaryNumber = 0;
    int remainder, k = 1, step = 1;

    while (sum!=0)
    {
        remainder = sum%2;
       // printf("Step %d: %d/2, Remainder = %d, Quotient = %d\n", step++, n, remainder, n/2);
        sum /= 2;
        binaryNumber += remainder*k;
        k *= 10;
    }
   printf("%lld", binaryNumber);

}


